# Решето Эратосфена с линейным временем работы
Решето Эратосфена используется для нахождения всех простых делителей на промежутке `[2; N]` (`N` задается). Предложенная здесь реализация выполняет `O(N)` операций.

## Идея
Будем хранить массив `lp[N]`, где `lp[i]` - минимальный делитель числа `i`. Изначально он заполнен нулями (то есть, мы считаем все числа простыми) и будет обновляться при подсчете. Также будем хранить список найденных простых чисел `pr`.

Очевидно, что если в цикле мы встретили `i`, для которого `lp[i] == 0`, мы нашли простое число. Присваиваем в `lp[i]` само `i`, добавляем `i` в `pr`. Если же `lp[i] != 0`, мы встретили составное число. В любом случае мы будем брать числа `x`, кратные `i`, и будем обновлять у них `lp[x]`. При этом делать это нужно не более одного раза, чтобы получить линейное время работы.
Представим, что `x[j] = i * pr[j]`, где `pr[j]` - это простое число, меньшее или равное `lp[i]`. Тогда очевидно, что `lp[x[j]] = pr[j]`. 

![Псевдокод реализации алгоритма](data:image/png;base64,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 "Псевдокод")

## Нюанс
Разница между `O(N)` и `O(N log log N)` невелика. Обычное решето Эратосфена с оптимизациями может работать даже быстрее, чем решето "за линию". С памятью все еще хуже - в обычном решете мы храним массив `bool`'ов (и то, можно уменьшить в 8 раз), здесь же мы храним два массива 4-битных чисел. Чаще всего "линейное" решето используется для нахождения всех `lp[i]`.

## Задачи
## Задачи
- [Найти количество простых чисел на промежутке от a до b](https://www.e-olymp.com/ru/problems/4739)
- [Найти количество простых чисел на промежутке от 1 до n](https://informatics.mccme.ru/mod/statements/view3.php?id=19257&chapterid=112488#1)